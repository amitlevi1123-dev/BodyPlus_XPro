<!-- admin_web/templates/_sidebar.html -->
<aside class="fixed right-0 top-0 h-full w-64 bg-white border-l border-gray-200 shadow-sm">
  <div class="p-4 border-b">
    <a href="{{ url_for('dashboard') }}">
      <img src="{{ url_for('static', filename='images/logo.png') }}"
           alt="BodyPlus XPro"
           class="h-10 w-auto mx-auto"
           onerror="this.style.display='none'">
    </a>
  </div>

  {% set ep = request.endpoint.split('.')[-1] if request.endpoint else '' %}

  <nav class="p-3 space-y-1 text-sm">

    <a href="{{ url_for('dashboard') }}"
       class="flex items-center justify-between px-3 py-2 rounded-lg
              {{ 'bg-sky-100 text-sky-600 font-semibold' if ep=='dashboard' else 'text-gray-700 hover:bg-gray-50' }}">
      <span>לוח בקרה</span>
      <span class="text-xs text-gray-400">{{ app_version|default('dev') }}</span>
    </a>

    <a href="{{ url_for('metrics_page') }}"
       class="block px-3 py-2 rounded-lg
              {{ 'bg-sky-100 text-sky-600 font-semibold' if ep=='metrics_page' else 'text-gray-700 hover:bg-gray-50' }}">
      מדדים
    </a>

    <a href="{{ url_for('logs_page') }}"
       class="block px-3 py-2 rounded-lg
              {{ 'bg-sky-100 text-sky-600 font-semibold' if ep=='logs_page' else 'text-gray-700 hover:bg-gray-50' }}">
      לוגים
    </a>

    <a href="{{ url_for('compare_page') }}"
       class="block px-3 py-2 rounded-lg
              {{ 'bg-sky-100 text-sky-600 font-semibold' if ep=='compare_page' else 'text-gray-700 hover:bg-gray-50' }}">
      השוואה
    </a>

    <div class="mt-3 mb-1 px-3 text-xs font-semibold text-gray-400 select-none">וידאו</div>

    <a href="{{ url_for('video_page') }}"
       class="block px-3 py-2 rounded-lg
              {{ 'bg-sky-100 text-sky-600 font-semibold' if ep=='video_page' else 'text-gray-700 hover:bg-gray-50' }}">
      וידאו (מצלמה)
    </a>

    {# Object Detection page: /object-detection (endpoint="object_detection_page") #}
    {% set od_href = url_for('object_detection_page') if has_endpoint('object_detection_page') else '/object-detection' %}
    {% set od_active = (ep == 'object_detection_page') or (request.path == '/object-detection') %}
    <a href="{{ od_href }}"
       class="block px-3 py-2 rounded-lg
              {{ 'bg-sky-100 text-sky-600 font-semibold' if od_active else 'text-gray-700 hover:bg-gray-50' }}">
      זיהוי אובייקטים
    </a>

    {# Capture page: /capture #}
    {% set capture_href = url_for('capture_page') if has_endpoint('capture_page') else '/capture' %}
    {% set capture_active = (ep == 'capture_page') or (request.path == '/capture') %}
    <a href="{{ capture_href }}"
       class="block px-3 py-2 rounded-lg
              {{ 'bg-green-100 text-green-700 font-semibold' if capture_active else 'text-gray-700 hover:bg-gray-50' }}">
      שידור מהדפדפן (Capture)
    </a>

    {# Optional: open raw MJPEG in new tab #}
    <a href="/video/stream.mjpg?hud=1" target="_blank" rel="noopener"
       class="block px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-50">
      פתיחת זרם MJPEG ↗
    </a>

    {# Optional upload page if blueprint exists #}
    {% if has_endpoint('upload_video.upload_video_page') %}
      <a href="{{ url_for('upload_video.upload_video_page') }}"
         class="block px-3 py-2 rounded-lg
                {{ 'bg-sky-100 text-sky-600 font-semibold' if ep=='upload_video_page' else 'text-gray-700 hover:bg-gray-50' }}">
        העלאת וידאו 🎬
      </a>
    {% endif %}

    {# Exercise page if exists #}
    {% if has_endpoint('exercise_page') %}
      <a href="{{ url_for_safe('exercise_page') }}"
         class="block px-3 py-2 rounded-lg
                {{ 'bg-sky-100 text-sky-600 font-semibold' if ep=='exercise_page' else 'text-gray-700 hover:bg-gray-50' }}">
        זיהוי תרגיל
      </a>
    {% endif %}

    {# System page if exists #}
    {% if has_endpoint('system_page') %}
      <a href="{{ url_for_safe('system_page') }}"
         class="block px-3 py-2 rounded-lg
                {{ 'bg-sky-100 text-sky-600 font-semibold' if ep=='system_page' else 'text-gray-700 hover:bg-gray-50' }}">
        מצב מערכת
      </a>
    {% endif %}

    <a href="{{ url_for('settings_page') }}"
       class="block px-3 py-2 rounded-lg
              {{ 'bg-sky-100 text-sky-600 font-semibold' if ep=='settings_page' else 'text-gray-700 hover:bg-gray-50' }}">
      הגדרות
    </a>

  </nav>
</aside>
