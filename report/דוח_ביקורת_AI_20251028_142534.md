# 📋 דוח ביקורת AI — BodyPlus_XPro

- ⏱ חלון בדיקה: 30 שניות
- 🧭 פקודה: `python app\main.py`

- 🤖 סטטוס AI: יש API | GPT: שגיאה (401 Client Error: Unauthorized for url: https://api.openai.com/v1/responses)

## ✅ Health (מצב אחרון)
- `/api/diagnostics` → ok=False code=404
- `/video/stream.mjpg` → ok=False code=404

## 🎥 וידאו/קינמטיקה/זיהוי אובייקט — אינדיקציות
- pose.available זוהה בלוגים: לא
- objdet.*_present זוהה בלוגים: לא
- /video/stream.mjpg: לא OK

## ⚠️ תקלות שאובחנו
### • HTTP 500 / Exception
**למה זה קורה:** חריגה בקוד השרת.
**איך לתקן:** בדוק Traceback (קובץ/שורה) ותקן None/KeyError/TypeError וכו׳.

### • Object detection not running
**למה זה קורה:** זיהוי אובייקטים לא רץ/מודל לא נטען.
**איך לתקן:** בדוק פרופיל דיטקטור, נתיבי מודלים, גרסת onnxruntime ולוג OD.


## 🧾 קטע לוג אחרון (עד 60 שורות)
```text
[32m14:25:07[0m | [1mINFO    [0m | [36mcore.logs[0m:[36mod_event[0m:[36m385[0m - [1m[OD1020] config YAML loaded[0m
--- Logging error in Loguru Handler #4 ---
Record was: {'elapsed': datetime.timedelta(seconds=3, microseconds=569556), 'exception': None, 'extra': {}, 'file': (name='config_loader.py', path='C:\\Users\\Owner\\Desktop\\BodyPlus\\BodyPlus_XPro\\core\\object_detection\\config_loader.py'), 'function': '_log', 'level': (name='INFO', no=20, icon='\u2139\ufe0f'), 'line': 34, 'message': "[config] moved sections: ['tracker\u2192tracking']", 'module': 'config_loader', 'name': 'core.object_detection.config_loader', 'process': (id=322028, name='MainProcess'), 'thread': (id=101120, name='MainThread'), 'time': datetime(2025, 10, 28, 14, 25, 7, 980240, tzinfo=datetime.timezone(datetime.timedelta(seconds=7200), '���� ���� �������'))}
Traceback (most recent call last):
  File "C:\Users\Owner\Desktop\BodyPlus\.venv\Lib\site-packages\loguru\_handler.py", line 206, in emit
    self._sink.write(str_record)
  File "C:\Users\Owner\Desktop\BodyPlus\.venv\Lib\site-packages\loguru\_simple_sinks.py", line 16, in write
    self._stream.write(message)
  File "C:\Users\Owner\AppData\Local\Programs\Python\Python311\Lib\encodings\cp1255.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'charmap' codec can't encode character '\u2192' in position 150: character maps to <undefined>
--- End of logging error ---
[32m14:25:08[0m | [1mINFO    [0m | [36mcore.object_detection.config_loader[0m:[36m_log[0m:[36m34[0m - [1m[config] sections detected: ['active_profile', 'classes', 'env_override', 'profiles', 'tracking', 'tracking_enabled', 'ui_label_map'][0m
[32m14:25:08[0m | [1mINFO    [0m | [36mcore.logs[0m:[36mod_event[0m:[36m385[0m - [1m[OD1010] profile selected[0m
[32m14:25:08[0m | [1mINFO    [0m | [36mcore.object_detection.config_loader[0m:[36m_log[0m:[36m34[0m - [1m[config:detector] accepted keys: ['clip_to_frame', 'device', 'extra', 'max_objects', 'overlap', 'period_ms', 'provider', 'threshold', 'weights'][0m
[32m14:25:08[0m | [1mINFO    [0m | [36mcore.object_detection.config_loader[0m:[36m_log[0m:[36m34[0m - [1m[config:angle] accepted keys: [][0m
[32m14:25:08[0m | [1mINFO    [0m | [36mcore.object_detection.config_loader[0m:[36m_log[0m:[36m34[0m - [1m[config:tracking] ignored keys: ['conf_threshold', 'iou_threshold', 'max_age', 'type'][0m
[32m14:25:08[0m | [1mINFO    [0m | [36mcore.object_detection.config_loader[0m:[36m_log[0m:[36m34[0m - [1m[config:tracking] accepted keys: [][0m
[32m14:25:08[0m | [1mINFO    [0m | [36mcore.object_detection.config_loader[0m:[36m_log[0m:[36m34[0m - [1m[config:features] accepted keys: [][0m
[32m14:25:08[0m | [1mINFO    [0m | [36mcore.logs[0m:[36mod_event[0m:[36m385[0m - [1m[OD1020] simple overrides applied[0m
[32m14:25:08[0m | [1mINFO    [0m | [36mcore.object_detection.config_loader[0m:[36m_log[0m:[36m34[0m - [1m[config] injected class_names from YAML classes (2 classes)[0m
[32m14:25:08[0m | [1mINFO    [0m | [36mcore.logs[0m:[36mod_event[0m:[36m385[0m - [1m[OD1020] config built (profile)[0m
[32m14:25:08[0m | [1mINFO    [0m | [36mcore.logs[0m:[36mod_event[0m:[36m385[0m - [1m[OD1020] config loaded[0m
[32m14:25:08[0m | [1mINFO    [0m | [36mcore.object_detection.detector_base[0m:[36m_resolve_provider[0m:[36m445[0m - [1mDetector provider resolve: yolov8[0m
[32m14:25:12[0m | [33m[1mWARNING [0m | [36mcore.object_detection.detector_base[0m:[36m_resolve_provider[0m:[36m464[0m - [33m[1mYOLOv8 provider init failed -> devnull (ultralytics not installed: module 'cv2' has no attribute 'setNumThreads')[0m
[32m14:25:12[0m | [1mINFO    [0m | [36mcore.object_detection.detector_base[0m:[36mapply_simple[0m:[36m568[0m - [1m[Detector.apply_simple] rate_ms=120 thr=0.15 max=50 safe=(True, 6) tracking=False imgsz=640[0m
[32m14:25:12[0m | [1mINFO    [0m | [36mcore.object_detection.detector_base[0m:[36m__init__[0m:[36m271[0m - [1mDetectorService init: provider=yolov8 thr=0.15 ov=0.5 max=50 imgsz=640 track?=False[0m
[32m14:25:12[0m | [1mINFO    [0m | [36mcore.logs[0m:[36mod_event[0m:[36m385[0m - [1m[OD1000] Engine init[0m
[32m14:25:12[0m | [1mINFO    [0m | [36mcore.logs[0m:[36mod_event[0m:[36m385[0m - [1m[OD1001] model/provider ready[0m
[32m14:25:12[0m | [1mINFO    [0m | [36mcore.logs[0m:[36mod_event[0m:[36m385[0m - [1m[OD1000] done OK[0m
[32m14:25:12[0m | [1mINFO    [0m | [36m__main__[0m:[36m_init_object_detection[0m:[36m446[0m - [1m���� ����� ��������� ����� (period=200ms)[0m
[32m14:25:12[0m | [1mINFO    [0m | [36madmin_web.state[0m:[36mset_od_engine[0m:[36m191[0m - [1m[STATE:set_od_engine] hooked provider=yolov8[0m
[32m14:25:12[0m | [1mINFO    [0m | [36m__main__[0m:[36m_init_object_detection[0m:[36m449[0m - [1mOD engine registered to admin_web.state[0m
[32m14:25:12[0m | [1mINFO    [0m | [36mcore.logs[0m:[36msetup_logging[0m:[36m251[0m - [1m===== BodyPlus_XPro logging started =====[0m
[32m14:25:12[0m | [1mINFO    [0m | [36mcore.logs[0m:[36msetup_logging[0m:[36m252[0m - [1mConsole level=INFO | File level=DEBUG | UI level=WARNING[0m
[32m14:25:12[0m | [1mINFO    [0m | [36mcore.logs[0m:[36msetup_logging[0m:[36m253[0m - [1mOD min level=30 | Noisy: window=2.0s max=1 | Alerts gap=8.0s[0m
[32m14:25:12[0m | [1mINFO    [0m | [36mcore.logs[0m:[36msetup_logging[0m:[36m254[0m - [1mSampling: win=5.0s max=8 | DeDup=True(1.5s) | SYS->file only=True[0m
[32m14:25:12[0m | [1mINFO    [0m | [36madmin_web.server[0m:[36mcreate_app[0m:[36m298[0m - [1m[Server] Registered video_bp blueprint[0m
[32m14:25:12[0m | [1mINFO    [0m | [36madmin_web.server[0m:[36mcreate_app[0m:[36m302[0m - [1m[Server] Registered upload_video_bp blueprint[0m
[32m14:25:12[0m | [1mINFO    [0m | [36madmin_web.server[0m:[36mcreate_app[0m:[36m306[0m - [1m[Server] Registered actions_bp (/api/action)[0m
[32m14:25:12[0m | [1mINFO    [0m | [36madmin_web.server[0m:[36mcreate_app[0m:[36m310[0m - [1m[Server] Registered state_bp (/api/video/state)[0m
[32m14:25:12[0m | [1mINFO    [0m | [36madmin_web.server[0m:[36mcreate_app[0m:[36m314[0m - [1m[Server] Registered logs_bp (/api/logs*)[0m
[32m14:25:12[0m | [1mINFO    [0m | [36madmin_web.server[0m:[36mcreate_app[0m:[36m322[0m - [1m[Server] Registered system_bp (/version,/healthz,�)[0m
[32m14:25:12[0m | [1mINFO    [0m | [36madmin_web.server[0m:[36mcreate_app[0m:[36m327[0m - [1mDB persist layer: %s[0m
[32m14:25:12[0m | [1mINFO    [0m | [36madmin_web.server[0m:[36mcreate_app[0m:[36m331[0m - [1m=== Admin UI (Flask � Browser ingest) ===[0m
[32m14:25:12[0m | [1mINFO    [0m | [36madmin_web.server[0m:[36mcreate_app[0m:[36m332[0m - [1mAPP_VERSION=dev  DEFAULT_BACKEND=(none)[0m
[32m14:25:12[0m | [1mINFO    [0m | [36m__main__[0m:[36m_run[0m:[36m193[0m - [1mAdmin UI starting on http://127.0.0.1:5000[0m
 * Serving Flask app 'admin_web.server'
 * Debug mode: off
[32m14:25:22[0m | [33m[1mWARNING [0m | [36m__main__[0m:[36m_loop[0m:[36m469[0m - [33m[1m[Watchdog] video stalled (no_frames=True, fps=None); restarting�[0m
[32m14:25:22[0m | [33m[1mWARNING [0m | [36m__main__[0m:[36mvideo_restart[0m:[36m314[0m - [33m[1mvideo_restart(): stopping�[0m
[32m14:25:22[0m | [1mINFO    [0m | [36m__main__[0m:[36mvideo_stop[0m:[36m308[0m - [1mvideo_stop() invoked[0m
[32m14:25:23[0m | [33m[1mWARNING [0m | [36m__main__[0m:[36mvideo_restart[0m:[36m317[0m - [33m[1mvideo_restart(): starting�[0m
[32m14:25:23[0m | [1mINFO    [0m | [36m__main__[0m:[36mvideo_start[0m:[36m299[0m - [1mvideo_start() invoked[0m
[32m14:25:32[0m | [33m[1mWARNING [0m | [36m__main__[0m:[36m_loop[0m:[36m469[0m - [33m[1m[Watchdog] video stalled (no_frames=True, fps=None); restarting�[0m
[32m14:25:32[0m | [33m[1mWARNING [0m | [36m__main__[0m:[36mvideo_restart[0m:[36m314[0m - [33m[1mvideo_restart(): stopping�[0m
[32m14:25:32[0m | [1mINFO    [0m | [36m__main__[0m:[36mvideo_stop[0m:[36m308[0m - [1mvideo_stop() invoked[0m
[32m14:25:33[0m | [33m[1mWARNING [0m | [36m__main__[0m:[36mvideo_restart[0m:[36m317[0m - [33m[1mvideo_restart(): starting�[0m
[32m14:25:33[0m | [1mINFO    [0m | [36m__main__[0m:[36mvideo_start[0m:[36m299[0m - [1mvideo_start() invoked[0m
```