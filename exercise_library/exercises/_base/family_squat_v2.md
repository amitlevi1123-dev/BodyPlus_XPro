מצוין 👌
הנה הגרסה המעודכנת — **ללא החלק של “8️⃣ פידבק בזמן אמת (קולי / coach_rt)”**.
זה הקובץ שאתה יכול לשמור ישירות כ־
`docs/specs/family_squat_v2.md`:

---

````markdown
# 🧩 משפחת Squat — מפרט מלא (v2)

> **מטרה:**  
> להעריך את איכות ובטיחות תנועת הסקוואט בצורה מקצועית, מותאמת אישית ובעלת ערך למשתמש.  
> הדגש הוא על טכניקה בטוחה, שליטה יציבה, ופידבק חכם שמדריך ולא מעניש.

---

## 1️⃣ עקרונות כלליים

| תחום | עיקרון |
|-------|----------|
| **בטיחות תחילה** | עגילת גב, קריסת ברכיים ועיקום צדדי נחשבים חריגים חמורים. |
| **שונות טבעית מותרת** | נטיית גב קדימה, זווית רגליים ופתיחת ירכיים שונות בין אנשים — לא להעניש עליהן. |
| **תגמול חכם** | ככל שהירידה מבוקרת ועמוקה יותר עד 90°, הציון עולה. מעבר ל־90° לא מוסיף. |
| **עקבים נעוצים** | חובה לשמור על מגע עקבים — אם הם עולים, ניתנת התראה וציון יורד קלות. |
| **מבט וראש** | הראש בקו עם עמוד השדרה, מבט קדימה; לא למטה או למעלה. |
| **כפות רגליים** | פתוחות החוצה קלות (8–20°) — לא ענישה אלא הדרכה. |
| **פידבק תמידי** | גם אם הכול תקין, המשתמש יקבל פידבק חיובי (“ביצוע מצוין”). |

---

## 2️⃣ מדדים נדרשים (קנוניים לפי aliases.yaml)

| תחום | מפתח | יחידה |
|-------|-------|--------|
| עגילת גב | `spine_flexion_deg` | deg |
| עיקום צדדי | `spine_curvature_side_deg` | deg |
| ולגוס | `knee_foot_alignment_left_deg`, `knee_foot_alignment_right_deg` | deg |
| עומק סקוואט | `knee_left_deg`, `knee_right_deg` | deg |
| רוחב עמידה | `features.stance_width_ratio` | ratio |
| זווית כפות רגליים | `toe_angle_left_deg`, `toe_angle_right_deg` | deg |
| תנוחת ראש/צוואר | `head_pitch_deg` | deg |
| עקבים נעוצים | `heel_lift_left`, `heel_lift_right` | bool |
| טמפו | `rep.timing_s` | s |
| דורסיפלקשן (פידבק) | `ankle_dorsi_left_deg`, `ankle_dorsi_right_deg` | deg |
| נטיית גו (פידבק בלבד) | `torso_forward_deg` | deg |
| כשירות מדידה | `pose.available`, `pose.confidence`, `average_visibility` | bool/ratio |

---

## 3️⃣ קריטריונים וציון

### 🛡️ בטיחות (60%)

| קריטריון | טווח טוב | בינוני | גרוע | משקל |
|------------|-----------|---------|--------|---------|
| **עגילת גב** (`spine_flexion_deg`) | ≤10° | 10–20° | ≥35° | 2.0 |
| **ולגוס בברכיים** (`max(|kfa_L|,|kfa_R|)`) | ≤5° | 5–10° | ≥20° | 2.0 |
| **עיקום צדדי** (`spine_curvature_side_deg`) | ≤5° | 5–10° | ≥20° | 1.5 |

> חריגה בערכים אלה מפעילה *Safety Cap* על הציון הכללי.

---

### ⚙️ טכניקה (40%)

| קריטריון | טווח טוב | בינוני | גרוע | משקל |
|------------|-----------|---------|--------|---------|
| **עומק סקוואט** (`min(knee_left,right_deg)`) | עד 90° = מושלם | 90–150° = יורד בהדרגה | ≥150° = גרוע | 1.2 |
| **רוחב עמידה** (`features.stance_width_ratio`) | 0.9–1.2 | 0.8–1.3 | <0.7 / >1.5 | 0.8 |
| **זווית כפות רגליים** (`toe_angle_avg`) | 8–20° | 0–8° / 20–30° | <0° / >30° | 0.8 |
| **יישור ראש לצוואר** (`|head_pitch_deg - spine_flexion_deg|`) | ≤10° | 10–20° | ≥30° | 0.8 |
| **עקבים נעוצים** (`max(heel_lift_left,right)`) | 0 (נעוצים) | — | 1 (מורם) | 0.6 |
| **קצב חזרה (טמפו)** (`rep.timing_s`) | 0.7–2.5s | 0.5–3.5s | <0.4 / >4.0 | 0.5 |
| **דורסיפלקשן** *(פידבק בלבד)* | ≥25° | 15–25° | <15° | 0.3 |

---

## 4️⃣ ציון כללי

- שיטת שקלול: `weighted_mean`
- קריטריונים חסרים: `skip`
- דרישת מינימום לאיכות מלאה: 3 קריטריונים זמינים  
- **אין Grade A/B/C**, רק ציון מספרי כולל: `score.overall`

---

## 5️⃣ תקרות בטיחות (Safety Caps)

| תנאי | הגבלת ציון |
|-------|--------------|
| `spine_rounding <= 0.6` | cap = 0.70 |
| `knee_valgus <= 0.6` | cap = 0.75 |
| `spine_sidebend <= 0.6` | cap = 0.80 |

---

## 6️⃣ רמזי זיהוי (Match Hints)

```yaml
must_have: [pose.available]
pose_view: ["front", "front_left", "front_right"]
motion_pattern: ["hip_down", "knee_flexion"]
joints_focus: ["hips", "knees", "spine"]
````

---

## 7️⃣ פידבק מרכזי (לאחרי סט)

| תנאי                            | הודעה                                                    |
| ------------------------------- | -------------------------------------------------------- |
| `spine_flexion_deg>20°`         | “שמור על גב נייטרלי – אל תרד מעבר לנקודה שבה הגב מתעגל.” |
| `knee_valgus>10°`               | “הברכיים נקרסות פנימה – דחוף אותן החוצה לאורך הירידה.”   |
| `toe_angle<8°`                  | “סובב מעט את כפות הרגליים החוצה ליציבות טובה יותר.”      |
| `head_alignment>20°`            | “הראש לא בקו עם הגב – שמור על מבט קדימה.”                |
| `heel_lift_left/right=1`        | “העקבים עולים – שמור עקב נעוץ בקרקע.”                    |
| `ankle_dorsi_min<15°`           | “גמישות הקרסול מוגבלת – תרגילי דורסיפלקשן ישפרו עומק.”   |
| `depth≈90° & spine_flexion≤10°` | “עומק מצוין עם גב נייטרלי – ביצוע מקצועי.”               |

---

## 8️⃣ עקרונות סופיים

* עד 90° עומק = **ציון מלא**.
* מעבר ל־90° לא מוסיף ציון.
* חריגה באחד הקריטריונים הבטיחותיים מגבילה את הציון הכולל.
* עקבים חייבים להישאר במגע עם הרצפה.
* פידבק חיובי יופיע גם כשאין שגיאות.
* הנתונים והתיאורים מותאמים לשפה קולית ניטרלית בעברית.

---

> קובץ זה הוא הבסיס לכל גרסאות הסקוואט (Bodyweight, Goblet, Barbell).
> כל וריאנט יורש ממנו ומשנה רק פרטים קטנים כמו טמפו או דרישת עומק.

```

---

רוצה שאשמור לך עכשיו את אותו הקובץ גם כ־`squat.base.yaml` תואם למנוע (לפי המפרט הזה)?
```
