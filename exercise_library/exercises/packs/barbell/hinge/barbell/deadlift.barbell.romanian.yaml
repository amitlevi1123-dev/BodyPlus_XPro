# =============================================================================
# deadlift.barbell.romanian.yaml â€” Romanian Deadlift (RDL) ×¢× ××•×˜
# × ×ª×™×‘ ××•××œ×¥: exercise_library/exercises/packs/hinge/barbell/deadlift.barbell.romanian.yaml
# -----------------------------------------------------------------------------
# ×“×’×©×™×:
# â€¢ start_mode: from_standing â€” ××ª×—×™×œ×™× ×‘×¢××™×“×”, ×œ× ××”×¨×¦×¤×”
# â€¢ ×ª×‘× ×™×ª Hinge (×œ× ×¡×§×•×•××˜), ×‘×¨×š "×¤×ª×•×—×”" ×™×—×¡×™×ª
# â€¢ ROM ×§×¨×™×˜×™ ×•× ××“×“ ××–×•×•×™×•×ª ×™×¨×š/×’×• ×‘×œ×‘×“ (×œ× ×¤×™×§×¡×œ×™×)
# â€¢ ×¡×¤×™×¨×ª ×—×–×¨×” ××œ××”: â‰¥95% ××”×¢×œ×™×™×” (××™×Ÿ ×“×¨×™×©×ª "× ×¢×™×œ×” ××œ××”" ×›××• DL ×§×•× ×‘× ×¦×™×•× ×œ×™)
# â€¢ ×©×”×™×™×” ×××•×©×›×ª ××“×™ ×œ××¢×œ×” ××•×¨×™×“×” × ×™×§×•×“ (RDL ×©×•××¨ ××ª×—)
# â€¢ ×‘×˜×™×—×•×ª ×”×’×‘ ××•×“×’×©×ª ×‘××™×•×—×“
# =============================================================================

id: "deadlift.barbell.romanian"
family: "hinge"
extends: "hinge.base"

meta:
  selectable: true
  display_name: "Romanian Deadlift â€” Barbell (RDL)"
  equipment: "barbell"
  start_mode: "from_standing"
  version: "1.0.0"
  notes: >
    RDL ××Ÿ ×”×¢××™×“×”: ×“×—×™×¤×ª ××’×Ÿ ×œ××—×•×¨, ×”×“×’×©×ª ×˜×•×•×— ××§×¦× ×˜×¨×™ ×•×©××™×¨×ª ××ª×—.
    ××™×Ÿ ×¦×•×¨×š "×œ× ×¢×•×œ" ×œ××¢×œ×” â€” ×—×–×¨×” ××œ××” × ×¡×¤×¨×ª ×‘×”×©×œ××ª â‰¥95% ××”×¢×œ×™×™×”.
    ×©×”×™×™×” ××¨×•×›×” ×œ××¢×œ×” ××¢×™×“×” ×¢×œ ××•×‘×“×Ÿ ××ª×— ×•×œ×›×Ÿ ×× ×•×§×“×ª ××˜×”.
    ×¢×•××§/ROM ××—×•×©×‘×™× ××–×•×•×™×•×ª ×™×¨×š/×’×• ×•×œ×›×Ÿ ×¢××™×“×™× ×œ××¨×—×§ ××¦×œ××”.

# -----------------------------------------------------------------------------
# ğŸ§­ ×¨××–×™ ×–×™×”×•×™ ×œ××¡×•×•×’ (Classifier Hints)
# -----------------------------------------------------------------------------
match_hints:
  must_have: [pose.available]
  any_of: [objdet.bar_present, objdet.object_present]
  ranges:
    objdet.object_kind: ["barbell"]
  pose_view: ["side", "front_left", "front_right"]
  motion_pattern: ["hip_hinge"]
  joints_focus: ["hips", "spine", "knees"]
  weight: 1.0

# -----------------------------------------------------------------------------
# ğŸ¯ ×™×¢×“×™× ×œ×•×•×¨×™×× ×˜: ROM ××–×•×•×™×•×ª (Hip/Torso), ×•×§×•× ×˜×¨×•×œ ×œ××¢×œ×”
# -----------------------------------------------------------------------------
targets:
  rom_joint:
    hip_rom_deg: 48         # ×™×¢×“ ROM ×‘×™×¨×š
    torso_rom_deg: 30       # ×™×¢×“ ROM ×‘×’×•
  top_time_control:
    hold_good_max_s: 0.50   # ×¢×“ ×›××Ÿ ××™×“××œ×™ (×©×•××¨ ××ª×—)
    hold_ok_max_s:   1.00   # ×¢×“×™×™×Ÿ ×˜×•×‘
    hold_hard_cap_s: 2.50   # ××¢×‘×¨ ×œ×›×š â€” ×§× ×¡ ×‘×¨×•×¨

# -----------------------------------------------------------------------------
# â±ï¸ ×—×œ×•× ×•×ª ×˜××¤×• (×”×“×¨×›×ª×™×™×; ×”× ×™×§×•×“ ×‘×¤×•×¢×œ ×“×¨×š ×”×§×¨×™×˜×¨×™×•× ×™×)
# -----------------------------------------------------------------------------
tempo_targets:
  rep_t_s:   [1.0, 4.0]
  ecc_s:     [0.8, 3.0]
  con_s:     [0.6, 2.5]
  pause_bot: [0.0, 0.8]   # ×¡×˜Ö¾××¤ ×§×¦×¨ ×‘×ª×—×ª×™×ª
  pause_top: [0.0, 1.0]   # ××™×Ÿ ×¦×•×¨×š ×‘×”×—×–×§×”; ×¢×“×™×£ ×§×¦×¨ ×›×“×™ ×œ×©××•×¨ ××ª×—

# -----------------------------------------------------------------------------
# ğŸ¦¶ ×× ×— ×¨×’×œ×™×™× (×”×›×•×•× ×”)
# -----------------------------------------------------------------------------
stance_targets:
  stance_width_ratio: [0.85, 1.15]
  toe_angle_deg:      [5, 20]        # ×’× "×§×“×™××”" × ×¡×‘×œ
  knee_toe_alignment_ok_abs_deg: 5

# -----------------------------------------------------------------------------
# ğŸ” ×”×¢×“×¤×•×ª ×¡×¤×™×¨×ª ×—×–×¨×•×ª/×¤××–×•×ª
# -----------------------------------------------------------------------------
rep_detection_hints:
  prefer_angles: true            # ×¤××–×•×ª/ROM ××–×•×•×™×•×ª ×™×¨×š/×’×•
  use_object_y_as_aux: true      # ×¢×–×¨ ×œ××¡×œ×•×œ/×™×¦×™×‘×•×ª
  min_full_up_fraction: 0.95     # â‰¥95% ××”×¢×œ×™×™×” × ×¡×¤×¨ ×›×—×–×¨×” "××œ××”"

# -----------------------------------------------------------------------------
# âš–ï¸ ×“×¨×™×¡×•×ª × ×™×§×•×“ (scoring) â€” ××©×§×œ×™× 0â€“2 ×•×”×’×“×¨×•×ª ×›×œ×œ×™×•×ª
# ×”×¢×¨×”: ×× ×™×—×™× ×›×™ ×‘-hinge.base ×§×™×™××™× ×”×§×¨×™×˜×¨×™×•× ×™× ×”×‘××™× (policy.missing: skip).
# -----------------------------------------------------------------------------
scoring:

  # ××“×™× ×™×•×ª ×›×œ×œ×™×ª (× ×©××¨×ª ××”-base ×‘×“"×›)
  policy:
    missing: skip
    min_criteria_for_full_quality: 3

  criteria:

    # -------------------------
    # ×‘×˜×™×—×•×ª (×“×’×© ××•×’×‘×¨ ×œ×’×‘)
    # -------------------------
    spine_rounding:                # ×¢×’×™×œ×ª ×’×‘ (×¡×’×™×˜×œ×™)
      weight: 2.0                  # â†‘ ×—×©×•×‘ ×××•×“
      # rule × ×©××¨ ××”-base (symmetric_threshold spine_flexion_deg)

    lateral_bend:                  # ×¢×™×§×•× ×¦×“×“×™
      weight: 1.2

    head_spine:                    # ×¨××© ×‘×§×• ×”×’×•
      weight: 1.0

    # -------------------------
    # ×ª×‘× ×™×ª ×”×™× ×’'/×× ×™×¢×ª "×¡×§×•×•××˜"
    # -------------------------
    hinge_posture:                 # ×™×—×¡ ×’×•/×‘×¨×š â€” ×”×™× ×’' ×××™×ª×™ (×œ× ×¡×§×•×•××˜)
      weight: 1.6
      # rule × ×©××¨ ××”-base (×œ××©×œ band/ratio ×™×™×¢×•×“×™ ×× ×§×™×™×)

    knee_flex_limit:               # ×‘×¨×š "×¤×ª×•×—×”" (×œ×× ×•×¢ ×¡×§×•×•××˜)
      weight: 1.0
      # rule × ×©××¨ ××”-base (×¡×£ ××™× ' ×œ×–×•×•×™×ª ×‘×¨×š)

    # -------------------------
    # ROM ××–×•×•×™×•×ª (×§×¨×™×˜×™)
    # -------------------------
    rom_joint:                     # Hip/Torso ROM, ×¦×™×•×Ÿ ×©××¨× ×™ = ×”××™× ' ××‘×™×Ÿ ×”×©× ×™×™×
      weight: 1.8
      rule:
        kind: rom_joint_min_target
        input: { hip_rom_deg: "auto", torso_rom_deg: "auto" }   # ×× ×•×¢ ××—×©×‘ Î”×–×•×•×™×•×ª
        target_hip_deg:   48
        target_torso_deg: 30
        small_rep_min:    0.30   # <0.30 â†’ ×œ× × ×¡×¤×¨
        partial_min:      0.50   # 0.30â€“0.50 â†’ ×—×–×¨×” ×—×œ×§×™×ª
        full_up_fraction: 0.95   # ×”×©×œ××ª â‰¥95% ×¢×œ×™×™×” × ×—×©×‘×ª ××œ××”
        clamp_full_range: [0.95, 1.00]  # ×˜×•×œ×¨× ×¡ ××œ× â€” ×œ× "×§×•×¤×¥" 99â†’100

    # -------------------------
    # ×§×¦×‘/×©×œ×™×˜×”
    # -------------------------
    tempo:
      weight: 1.0

    phase_control:                 # ××™×›×•×ª ×¤××–×•×ª/×”×™×¤×•×š
      weight: 1.2

    # -------------------------
    # ×¨×’×œ×™×™×/×× ×—
    # -------------------------
    knee_valgus:
      weight: 1.2

    heels_grounded:
      weight: 0.8

    stance_width:
      weight: 0.6

    toe_angle:
      weight: 0.5

    # -------------------------
    # ×”×™×¤×•×š/"×˜×•×¤" ×™×™×—×•×“×™ ×œ-RDL
    # -------------------------
    turn_quality:
      weight: 0.6

    top_time_control:              # ×©×”×™×™×” ×œ××¢×œ×” â€” ×”×•×¨×“×” ×¨×›×” ×œ×¤×™ ×–××Ÿ
      weight: 0.6
      rule:
        kind: top_hold_penalty
        input: rep.pause_top_s
        good_max_s:   0.50   # ×œ×œ× ×”×•×¨×“×”
        ok_max_s:     1.00   # ×”×•×¨×“×” ×–×¢×™×¨×”/×œ×™× ×™××¨×™×ª
        hard_cap_s:   2.50   # ××¢×‘×¨ ×œ×›×š â€” ×”×•×¨×“×” ×‘×¨×•×¨×”

  # ×ª×§×¨×•×ª ×‘×˜×™×—×•×ª (××’×‘×™×œ×•×ª ×¦×™×•×Ÿ ×¡×•×¤×™ ×›×©×”×‘×˜×™×—×•×ª × ×¤×’×¢×ª)
  safety_caps:
    - when: "spine_rounding <= 0.60"   # ×’×‘ ××¢×•×’×œ â€” ×§×¤×“× ×™ ×™×•×ª×¨
      cap: 0.80
    - when: "knee_valgus   <= 0.60"
      cap: 0.90
    - when: "head_spine    <= 0.60"
      cap: 0.92

  # ×©×§×œ×•×œ ×¡×•×¤×™
  aggregate:
    method: weighted_mean
    weights_source: inline

# -----------------------------------------------------------------------------
# ğŸ“£ ×—×™×•×•×˜ ××©×¤×˜×™× (phrases)
# -----------------------------------------------------------------------------
phrases:
  namespace: "hinge.rdl"
  inherit_common_maps: true
  # ××™×¤×•×™×™× ××¤×©×¨×™×™× (×× ×”×•×’×“×¨×• ×‘-phrases.yaml):
  maps:
    rom_joint:
      rep_short: "hinge.common.rom_joint.rep_short"
      rep_too_short: "hinge.common.rom_joint.rep_too_short"
      rep_good: "hinge.common.rom_joint.rep_good"
    turn_quality:
      rep_weak: "hinge.common.turn.rep_weak"
      rep_good: "hinge.common.turn.rep_good"
    top_time_control:
      long_hold: "hinge.rdl.top_tension.rep_long_hold"     # ×“×•×’××” ×œ×©×•×¨×ª ×¤×™×“×‘×§
      too_locked: "hinge.rdl.top_tension.rep_too_locked"

# -----------------------------------------------------------------------------
# ğŸ§ª ×‘×“×™×§×•×ª ××•××œ×¦×•×ª (QA)
# -----------------------------------------------------------------------------
qa_notes:
  - "×¡×˜ ××³ ×œ×œ× ×¢×¦×™×¨×” ×œ××¢×œ×” ××•×œ ×¡×˜ ×‘×³ ×¢× 2â€“3s ×¢×¦×™×¨×”: ×¦×™×•×Ÿ ×‘×³ ×¦×¨×™×š ×œ×¨×“×ª ×“×¨×š top_time_control."
  - "×‘×“×•×§ ×©×—×–×¨×•×ª ×¢× 95â€“100% ×¢×œ×™×™×” × ×—×©×‘×•×ª ××œ××•×ª (×œ×œ× '×§×¤×™×¦×”' ×‘×™×Ÿ 99â†’100)."
  - "×•×“× ×©-ROM ××–×•×•×™×•×ª ×¢×•×‘×“ ×–×”×” ×××¨×—×§×™ ××¦×œ××” ×©×•× ×™×."
  - "×•×•×“× ×©×”×§×¨×™×˜×¨×™×•× ×™× ×©×œ ×”×™× ×’' (hinge_posture/knee_flex_limit) ××•× ×¢×™× '×¡×§×•×•××˜'."
  - "×¢×’×™×œ×ª ×’×‘ ××—××™×¨×”: spine_rounding<0.60 ××¤×¢×™×œ cap=0.80 ×¢×œ ×¦×™×•×Ÿ ×”×¡×•×¤×™."
