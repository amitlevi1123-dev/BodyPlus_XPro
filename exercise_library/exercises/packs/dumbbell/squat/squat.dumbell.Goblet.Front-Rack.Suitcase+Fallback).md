מעולה! הנה המסמך המסודר והמלא, כולל **טבלת משקלי ניקוד בין הווריאציות** (Goblet / Front-Rack / Suitcase / Fallback) + כל השאר בצורה נקייה וידידותית.

---

# 🏋️ סקוואט עם משקולות יד — מדריך וניתוח מלא

*(Goblet / Front-Rack / Suitcase + Fallback)*

## 🎯 מה זה ולמה חשוב

סקוואט עם משקולות יד הוא תרגיל בסיסי לחיזוק רגליים ויציבה. המטרה שלנו: **עומק נכון (≤90°), קצב מבוקר (2–5 שנ׳), ועמידה יציבה (לפחות ברוחב כתפיים)** — תוך שמירה על גב ניטרלי וברכיים בקו כפות הרגליים.
יש לנו 3 וריאציות עיקריות + וריאציית גיבוי אוטומטית (Fallback) כשיש חוסר ודאות בזיהוי.

---

## 🧩 הווריאציות בקצרה

| וריאציה                | איך מחזיקים                | יתרון עיקרי             | רגישות אופיינית    |
| ---------------------- | -------------------------- | ----------------------- | ------------------ |
| **Goblet**             | דאמבל יחיד מול החזה        | לימוד טכניקה, גב ניטרלי | לפעמים מהיר מדי    |
| **Front-Rack**         | שני דאמבלים על הכתפיים/חזה | שליטה קדמית גבוהה       | עייפות זרועות      |
| **Suitcase**           | שני דאמבלים בצידי הגוף     | שיפור איזון וסימטריה    | עיקום צדדי / עקבים |
| **General (Fallback)** | בחירה אוטומטית בעמימות     | מודד הכל “טוב מספיק”    | —                  |

---

## ⚙️ איך זה עובד במערכת (זרימה)

1. מצלמה מזהה גוף וציוד → 2) מסווג בוחר וריאציה (או Fallback) → 3) ספירת חזרות לפי תנועת האגן עם גיבויים → 4) ניקוד משוקלל לפי עומק/טמפו/עמידה/בטיחות → 5) **תקרות בטיחות** מגבילות ציון במצבי סיכון.

---

## 📏 מדידות שהמערכת בודקת

| מדד                     | מה נבדק            | ערך תקין/יעד              | הערות                    |            |                           |
| ----------------------- | ------------------ | ------------------------- | ------------------------ | ---------- | ------------------------- |
| **עומק (Depth)**        | זווית ברך מינימלית | ≤ 90°                     | עומק מלא = 1.0           |            |                           |
| **טמפו (Tempo)**        | משך חזרה           | 2–5 שניות                 | Cutoffs: 1.3 / 6.0       |            |                           |
| **רוחב עמידה (Stance)** | יחס לרוחב כתפיים   | **≥ 1.0×** (רך: 1.0–1.25) | < 0.85 = צר מדי          |            |                           |
| **עקבים (Heels)**       | מגע עקבים עם קרקע  | כן                        | הרמה = −50% בקריטריון    |            |                           |
| **עגילת גב**            | כיפוף קדמי         | טוב עד 10°                | 20° אזהרה, 35° גרוע      |            |                           |
| **ולגוס (Knee-Foot)**   | סטייה של הברך      | טוב עד 5°                 | 10° אזהרה, 20° גרוע      |            |                           |
| **עיקום צדדי**          | נטייה צדית של הגב  | טוב עד 5°                 | רלוונטי בעיקר ל-Suitcase |            |                           |
| **יישור ראש-גב**        |                    | Δ                         | ראש-גב                   | טוב עד 10° | ירידה קטנה בניקוד אם חורג |

> כל המפתחות תואמים ל־`aliases.yaml` שלך. העמידה נדרשת **לפחות ברוחב כתפיים**.

---

## ⚖️ טבלת משקלים לפי וריאציה (Scoring Weights)

> כל הקריטריונים משתמשים באותם כללי חישוב; ההבדל בין הוריאציות הוא **במשקלים**.

| קריטריון \ וריאציה                           |  Goblet | Front-Rack | Suitcase | Fallback |
| -------------------------------------------- | ------: | ---------: | -------: | -------: |
| **Depth** (≤90°)                             |     1.2 |    **1.3** |      1.2 |      1.3 |
| **Tempo** (2–5s)                             |     1.2 |    **1.3** |      1.2 |      1.2 |
| **Stance Width** (≥1.0× כתפיים; רך 1.0–1.25) |     0.8 |        0.9 |      0.9 |      0.9 |
| **Heels Grounded**                           |     0.8 |        0.8 |  **1.0** |      0.9 |
| **Spine Rounding**                           | **2.0** |    **2.0** |  **2.0** |  **2.0** |
| **Knee Valgus**                              | **2.0** |    **2.0** |  **2.0** |  **2.0** |
| **Spine Sidebend**                           |     1.3 |        1.3 |  **1.6** |      1.5 |
| **Head Alignment**                           |     0.8 |        0.8 |      0.8 |      0.8 |

**הסברים קצרים:**

* *Front-Rack* מקבל עדיפות קלה לטמפו/עומק (שליטה בעומס קדמי).
* *Suitcase* מעלה משקל לעיקום צדדי ולעקבים (נטייה לזוז/להתרומם).
* *Fallback* “באמצע” כדי להיות יציב במצבי עמימות.

---

## 🛡️ תקרות בטיחות (Safety Caps)

אם הציון התוך-קריטריוני יורד ל־0.6 או פחות, הציון הכולל מוגבל:

| תנאי                     | תקרת ציון |
| ------------------------ | --------: |
| **Spine Rounding ≤ 0.6** |  **0.70** |
| **Knee Valgus ≤ 0.6**    |  **0.75** |
| **Spine Sidebend ≤ 0.6** |  **0.80** |

---

## 🔁 ספירת חזרות חכמה + גיבויים

* מקור עיקרי: **`hip_y_px`**
* גיבויים: `hands_center_y`, `object_y`
* ספים: `min_rom_good: 60°`, `min_rep_ms: 600`, `max_rep_ms: 8000`

---

## 🧍‍♂️ כלל עמידה — לפחות ברוחב כתפיים

* יעד “רך”: **1.0–1.25×** רוחב כתפיים.
* מתחת **1.0** (ובוודאי מתחת **0.85**) → ירידת ניקוד.
* רחב מאוד (**>1.55**) גם יוריד (קושי לשמור יישור).

---

## 🧠 מתי עוברים ל-Fallback (כללי)

* זיהוי ציוד עמום/מתנדנד (דאמבל/קטלבל/לא ברור).
* `pose.confidence < 0.55` או חוסר עקביות בין פריימים.
* הפרש מסווג קטן בין שתי וריאציות (< 0.08).
* חסר עומק אמין אבל יש תנועת ירידה-עלייה — נמדוד “באופן חסין”.

---

## ❌ טעויות נפוצות ומה יופיע בפידבק

* עומק חלקי: “רד מעט יותר עד ~90°.”
* קצב מהיר מדי: “האט ל-2–5 שניות לחזרה.”
* גב מתעגל: “שמור גב ניטרלי; עצור לפני קריסה.”
* ברכיים פנימה: “שמור ברך בקו האצבעות.”
* עיקום צדדי (Suitcase): “ייצב מרכז כובד.”
* עקבים מתרוממים: “נעץ עקבים; העבר משקל מעט אחורה.”

---

## 📁 מבנה קבצים מומלץ

```
exercise_library/exercises/packs/dumbbell/squat/
  ├─ squat.dumbbell.goblet.yaml
  ├─ squat.dumbbell.front_rack.yaml
  ├─ squat.dumbbell.suitcase.yaml
  └─ squat.dumbbell.general.yaml   # Fallback
```

---

## ✅ צ’ק-ליסט להפעלה

* עומק נמדד ברור (≤90°)
* טמפו בין 2–5 שניות
* עמידה ≥ רוחב כתפיים
* עקבים במגע רציף
* גב ניטרלי, בלי עיקום צדדי
* ברכיים בקו כפות הרגליים
* עמימות? → Fallback נבחר אוטומטית

---

רוצה שאעדכן לך עכשיו את קבצי ה-YAML לפי המשקלים בטבלה (כולל כלל העמידה ≥ כתפיים) + אוסיף פסקאות `phrases` תואמות?
