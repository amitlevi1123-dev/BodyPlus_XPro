# -------------------------------------------------------------------
# squat.bodyweight.yaml â€” ×¡×§×•×•××˜ ××©×§×œ ×’×•×£ (Bodyweight Squat)
# -------------------------------------------------------------------
# ×ª×¨×’×™×œ ×–×” × ×•×¢×“ ×œ×‘×™×¦×•×¢ ×œ×œ× ×¦×™×•×“. ×™×•×¨×© ××ª ×›×œ ×—×•×§×™ ×”× ×™×§×•×“ ×•×”×‘×˜×™×—×•×ª
# ×Ö¾squat.base ×•××‘×¦×¢ ×”×ª×××•×ª ×§×œ×•×ª ×œ×¢×•××§, ×§×¦×‘ ×•×¨×•×—×‘ ×¢××™×“×”.
# -------------------------------------------------------------------

id: squat.bodyweight
family: squat
extends: squat.base

meta:
  selectable: true
  display_name: "×¡×§×•×•××˜ ××©×§×œ ×’×•×£"
  description: "×¡×§×•×•××˜ ×§×œ××¡×™ ×œ×œ× ×¦×™×•×“ â€” ×‘×•×“×§ ×©×œ×™×˜×”, ×¢×•××§ ×•×‘×˜×™×—×•×ª ×‘×ª× ×•×¢×” ×˜×‘×¢×™×ª."
  equipment: "none"   # ×—×™×™×‘ ×œ×”×™×•×ª ×‘×× ×’×œ×™×ª ×›×“×™ ×©×”××¡×•×•×’ ×™×‘×™×Ÿ ×©×–×” ×œ×œ× ×¦×™×•×“

# -------------------------------------------------------------------
# âš–ï¸ ×”×ª×××•×ª × ×™×§×•×“ (Scoring Overrides)
# -------------------------------------------------------------------
scoring:
  criteria:

    # ×¢×•××§ â€” ×‘××©×§×œ ×’×•×£ ××¤×©×¨ ×œ×©××•×£ ×œ×¢×•××§ ××¢×˜ ×’×“×•×œ ×™×•×ª×¨
    depth:
      weight: 1.3
      rule:
        kind: threshold_window
        input: "min(knee_left_deg, knee_right_deg)"
        target_max: 85          # â‰¤85Â° = ×¦×™×•×Ÿ ××œ×
        cutoff_max: 150         # â‰¥150Â° = 0
        direction: lower_is_better

    # ×§×¦×‘ â€” ×œ×¨×•×‘ ××”×™×¨ ×•×–×•×¨× ×™×•×ª×¨ ×××©×§×œ ×—×™×¦×•× ×™
    tempo:
      weight: 0.5
      rule:
        kind: tempo_window
        input: rep.timing_s
        min: 0.6
        max: 2.0
        cutoff_min: 0.3
        cutoff_max: 3.0

    # ×¨×•×—×‘ ×¢××™×“×” â€” ×¡×•×‘×œ× ×•×ª ×¨×—×‘×” ×™×•×ª×¨
    stance_width:
      weight: 0.8
      rule:
        kind: band_center
        input: features.stance_width_ratio
        min_ok: 0.85
        max_ok: 1.25
        cutoff_min: 0.65
        cutoff_max: 1.55

    # ×¢×§×‘×™× × ×¢×•×¦×™× â€” ×—×©×•×‘ ×œ×™×¦×™×‘×•×ª
    heels_grounded:
      weight: 0.8
      rule:
        kind: boolean_flag
        input: "(heel_lift_left or heel_lift_right)"  # True = ×™×© ×”×¨××”
        good_when: false                              # False = ×¢×§×‘×™× × ×¢×•×¦×™× (×˜×•×‘)
        penalty: 0.50                                 # ×¢× ×™×©×” ×‘×™× ×•× ×™×ª ×‘×”×¨××”

  # ×ª×§×¨×•×ª ×‘×˜×™×—×•×ª â€” × ×©××¨×•×ª ×›××• ×‘××©×¤×—×ª ×”×¡×§×•×•××˜
  safety_caps:
    - { when: "spine_rounding <= 0.6", cap: 0.70 }
    - { when: "knee_valgus   <= 0.6", cap: 0.75 }
    - { when: "spine_sidebend<= 0.6", cap: 0.80 }

# -------------------------------------------------------------------
# ğŸ§­ ×¨××–×™× ×œ×–×™×”×•×™ ××•×˜×•××˜×™ (Auto-Detection)
# -------------------------------------------------------------------
# ×× ×§×™×™× ×× ×’× ×•×Ÿ infer_equipment ×©×¢×•×‘×“ â€“ ××¡×¤×™×§ pose.available ×‘×œ×‘×“.
# ×× ×œ×, ×”×•×¡×¤× ×• must_not_have ×›×“×™ ×œ×× ×•×¢ ×‘×œ×‘×•×œ ×¢× ×ª×¨×’×™×œ×™ ×¦×™×•×“.
match_hints:
  must_have: [pose.available]
  must_not_have: [objdet.bar_present, objdet.dumbbell_present, objdet.kettlebell_present]
  pose_view: ["front", "front_left", "front_right"]
  weight: 1.0

# -------------------------------------------------------------------
# ğŸ” ×¡×¤×™×¨×ª ×—×–×¨×•×ª (Rep Signal)
# -------------------------------------------------------------------
# ××‘×•×¡×¡ ×¢×œ ×ª× ×•×¢×ª ×”××’×Ÿ (hip_y_px) â€” ×™×¦×™×‘ ×•×‘×˜×•×— ×’× ×‘×–×•×•×™×•×ª ××¦×œ××” ×©×•× ×•×ª.
rep_signal:
  source: "value|min|hip_y_px"
  thresholds:
    min_rom_good: 60
    min_rep_ms: 400
    max_rep_ms: 6000

# -------------------------------------------------------------------
# ğŸ—£ï¸ ×—×™×‘×•×¨ ×œ×¤×™×“×‘×§ (phrases.yaml)
# -------------------------------------------------------------------
# ×œ× ×“×•×¨×© ×©×™× ×•×™ ×‘×§×•×‘×¥ phrases.yaml â€” ×”×§×¨×™×˜×¨×™×•× ×™× ×›××Ÿ ×ª×•×××™× ×œ××¤×ª×—×•×ª:
# depth_knee, tempo, stance_width, heels_grounded, spine_rounding,
# spine_sidebend, knee_valgus, head_alignment, toe_angle ×•×›×•â€™.
# ××¢×¨×›×ª ×”×¤×™×“×‘×§ ×ª×–×”×” ××•×˜×•××˜×™×ª ×œ×¤×™ ×”×©××•×ª ×”×§× ×•× ×™×™×.
# -------------------------------------------------------------------
# âœ… ××•×›×Ÿ ×œ×©×™××•×© ××œ× â€” ××™×Ÿ ×¦×•×¨×š ×œ×¢×¨×•×š ××ª phrases.yaml ××• aliases.yaml.
# -------------------------------------------------------------------
